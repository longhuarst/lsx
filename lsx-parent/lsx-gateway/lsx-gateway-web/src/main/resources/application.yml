spring:
  application:
    name: lsx-gateway-web
  #配置跨域
  cloud:
    gateway:
      globalcors:
        cors-configurations:
          '[/**]': #匹配所有请求
            allowedOrigins: "*" #跨域处理 允许所有的域
            allowedMethods: #支持的方法
            - GET
            - POST
            - PUT
            - DELETE
      #配置路由
      routes:
      #唯一标识符
      - id: lsx_eureka_route
        #用户请求需要路由到该服务【指定要路由的服务】
        #uri: http://localhost:18881
        #lb:使用LoadBalancerClient 实现负载均衡， 后面跟的是微服务的名称【主要用于集群环境】
        #uri: lb://lsx-eureka
        uri: http://localhost:18881
        #路由断言，路由规则配置
        predicates:
        #用户请求的域名匹配配置，所有以lhc.com的请求都将被路由到 uri 指定的微服务去
#          - Host=lhc.com**
        #路径过滤
        #所有以/eureka开始的请求，都路由到http://localhost:18881微服务
        - Path=/eureka/**

        filters:
        #将请求路径中的第一个路径去掉，请求路径以/区分，一个/代表一个路径
        - StripPrefix=1
        #增加前缀
        #- PrefixPath=/xxx
      - id: lsx_service_test_route
        uri: http://localhost:18882
        predicates:
          - Path=/test/**
        filters:
          #局部限流过滤器
          - name: RequestRateLimiter #请求数限流，名字不能随便写，使用默认factory
            args: #参数
              key-resolver: "#{@ipKeyResolver}" #用户唯一识别标识符
              redis-rate-limiter.replenishRate: 10 #每秒钟只允许 10 个请求
              redis-rate-limiter.burstCapacity: 4 #允许并发有的请求【宽限的个数】
      - id: lsx_service_user_route
        uri: lb://lsx-service-user
        predicates:
          - Path=/user/**
        filters:
          - StripPrefix=1
  redis:
    host: localhost
    port: 16379
    jedis:
      pool:
        max-wait: 30000
        max-active: 100
        max-idle: 20
        min-idle: 0
    timeout: 3000

#
#spring:
#  application:
#    name: lsx-gateway-web
#  cloud:
#    gateway:
#      routes:
#      - id: blog
#        uri: http://localhost:18882
#        predicates:
#          # 匹配路径转发
#        - Path=/test


server:
  port: 18880
  #端口


management:
  endpoint:
    gateway:
      enabled: true
    web:
      exposure:
        ##暴露gateway端点
        include: gateway
  endpoints:
    web:
      exposure:
        include:

eureka:
  client:
    service-url:
      defaultZone: http://127.0.0.1:18881/eureka
  instance:
    prefer-ip-address: true





debug: true


